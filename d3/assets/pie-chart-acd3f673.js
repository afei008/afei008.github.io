import{g as O,s as gn,w as pn,h as dn}from"./config-5b4cdd90.js";import{a as mn}from"./array-9f3ba611.js";import{c as w}from"./constant-f354b64a.js";import{h as sn,e as M,t as U,c as k,a as V,m as en,b as on,p as fn,s as F,d as R,f as cn,g as yn,i as hn}from"./math-66d62dd6.js";import{w as vn}from"./path-bbeba479.js";import{S as xn}from"./Set3-b8bb04aa.js";import"./colors-98f238a0.js";function An(r){return r.innerRadius}function Rn(r){return r.outerRadius}function Tn(r){return r.startAngle}function wn(r){return r.endAngle}function Pn(r){return r&&r.padAngle}function bn(r,c,y,x,h,v,o,e){var g=y-r,u=x-c,n=o-h,p=e-v,a=p*g-n*u;if(!(a*a<M))return a=(n*(c-v)-p*(r-h))/a,[r+a*g,c+a*u]}function Q(r,c,y,x,h,v,o){var e=r-y,g=c-x,u=(o?v:-v)/F(e*e+g*g),n=u*g,p=-u*e,a=r+n,l=c+p,f=y+n,d=x+p,D=(a+f)/2,i=(l+d)/2,T=f-a,A=d-l,m=T*T+A*A,P=h-v,b=a*d-f*l,j=(A<0?-1:1)*F(hn(0,P*P*m-b*b)),q=(b*A-T*j)/m,C=(-b*T-A*j)/m,N=(b*A+T*j)/m,I=(-b*T+A*j)/m,S=q-D,t=C-i,s=N-D,E=I-i;return S*S+t*t>s*s+E*E&&(q=N,C=I),{cx:q,cy:C,x01:-n,y01:-p,x11:q*(h/P-1),y11:C*(h/P-1)}}function Mn(){var r=An,c=Rn,y=w(0),x=null,h=Tn,v=wn,o=Pn,e=null,g=vn(u);function u(){var n,p,a=+r.apply(this,arguments),l=+c.apply(this,arguments),f=h.apply(this,arguments)-sn,d=v.apply(this,arguments)-sn,D=on(d-f),i=d>f;if(e||(e=n=g()),l<a&&(p=l,l=a,a=p),!(l>M))e.moveTo(0,0);else if(D>U-M)e.moveTo(l*k(f),l*V(f)),e.arc(0,0,l,f,d,!i),a>M&&(e.moveTo(a*k(d),a*V(d)),e.arc(0,0,a,d,f,i));else{var T=f,A=d,m=f,P=d,b=D,j=D,q=o.apply(this,arguments)/2,C=q>M&&(x?+x.apply(this,arguments):F(a*a+l*l)),N=en(on(l-a)/2,+y.apply(this,arguments)),I=N,S=N,t,s;if(C>M){var E=cn(C/a*V(q)),G=cn(C/l*V(q));(b-=E*2)>M?(E*=i?1:-1,m+=E,P-=E):(b=0,m=P=(f+d)/2),(j-=G*2)>M?(G*=i?1:-1,T+=G,A-=G):(j=0,T=A=(f+d)/2)}var z=l*k(T),B=l*V(T),H=a*k(P),J=a*V(P);if(N>M){var K=l*k(A),L=l*V(A),W=a*k(m),X=a*V(m),$;if(D<fn)if($=bn(z,B,W,X,K,L,H,J)){var Y=z-$[0],Z=B-$[1],_=K-$[0],nn=L-$[1],un=1/V(yn((Y*_+Z*nn)/(F(Y*Y+Z*Z)*F(_*_+nn*nn)))/2),ln=F($[0]*$[0]+$[1]*$[1]);I=en(N,(a-ln)/(un-1)),S=en(N,(l-ln)/(un+1))}else I=S=0}j>M?S>M?(t=Q(W,X,z,B,l,S,i),s=Q(K,L,H,J,l,S,i),e.moveTo(t.cx+t.x01,t.cy+t.y01),S<N?e.arc(t.cx,t.cy,S,R(t.y01,t.x01),R(s.y01,s.x01),!i):(e.arc(t.cx,t.cy,S,R(t.y01,t.x01),R(t.y11,t.x11),!i),e.arc(0,0,l,R(t.cy+t.y11,t.cx+t.x11),R(s.cy+s.y11,s.cx+s.x11),!i),e.arc(s.cx,s.cy,S,R(s.y11,s.x11),R(s.y01,s.x01),!i))):(e.moveTo(z,B),e.arc(0,0,l,T,A,!i)):e.moveTo(z,B),!(a>M)||!(b>M)?e.lineTo(H,J):I>M?(t=Q(H,J,K,L,a,-I,i),s=Q(z,B,W,X,a,-I,i),e.lineTo(t.cx+t.x01,t.cy+t.y01),I<N?e.arc(t.cx,t.cy,I,R(t.y01,t.x01),R(s.y01,s.x01),!i):(e.arc(t.cx,t.cy,I,R(t.y01,t.x01),R(t.y11,t.x11),!i),e.arc(0,0,a,R(t.cy+t.y11,t.cx+t.x11),R(s.cy+s.y11,s.cx+s.x11),i),e.arc(s.cx,s.cy,I,R(s.y11,s.x11),R(s.y01,s.x01),!i))):e.arc(0,0,a,P,m,i)}if(e.closePath(),n)return e=null,n+""||null}return u.centroid=function(){var n=(+r.apply(this,arguments)+ +c.apply(this,arguments))/2,p=(+h.apply(this,arguments)+ +v.apply(this,arguments))/2-fn/2;return[k(p)*n,V(p)*n]},u.innerRadius=function(n){return arguments.length?(r=typeof n=="function"?n:w(+n),u):r},u.outerRadius=function(n){return arguments.length?(c=typeof n=="function"?n:w(+n),u):c},u.cornerRadius=function(n){return arguments.length?(y=typeof n=="function"?n:w(+n),u):y},u.padRadius=function(n){return arguments.length?(x=n==null?null:typeof n=="function"?n:w(+n),u):x},u.startAngle=function(n){return arguments.length?(h=typeof n=="function"?n:w(+n),u):h},u.endAngle=function(n){return arguments.length?(v=typeof n=="function"?n:w(+n),u):v},u.padAngle=function(n){return arguments.length?(o=typeof n=="function"?n:w(+n),u):o},u.context=function(n){return arguments.length?(e=n??null,u):e},u}function In(r,c){return c<r?-1:c>r?1:c>=r?0:NaN}function Sn(r){return r}function Dn(){var r=Sn,c=In,y=null,x=w(0),h=w(U),v=w(0);function o(e){var g,u=(e=mn(e)).length,n,p,a=0,l=new Array(u),f=new Array(u),d=+x.apply(this,arguments),D=Math.min(U,Math.max(-U,h.apply(this,arguments)-d)),i,T=Math.min(Math.abs(D)/u,v.apply(this,arguments)),A=T*(D<0?-1:1),m;for(g=0;g<u;++g)(m=f[l[g]=g]=+r(e[g],g,e))>0&&(a+=m);for(c!=null?l.sort(function(P,b){return c(f[P],f[b])}):y!=null&&l.sort(function(P,b){return y(e[P],e[b])}),g=0,p=a?(D-u*A)/a:0;g<u;++g,d=i)n=l[g],m=f[n],i=d+(m>0?m*p:0)+A,f[n]={data:e[n],index:g,value:m,startAngle:d,endAngle:i,padAngle:T};return f}return o.value=function(e){return arguments.length?(r=typeof e=="function"?e:w(+e),o):r},o.sortValues=function(e){return arguments.length?(c=e,y=null,o):c},o.sort=function(e){return arguments.length?(y=e,c=null,o):y},o.startAngle=function(e){return arguments.length?(x=typeof e=="function"?e:w(+e),o):x},o.endAngle=function(e){return arguments.length?(h=typeof e=="function"?e:w(+e),o):h},o.padAngle=function(e){return arguments.length?(v=typeof e=="function"?e:w(+e),o):v},o}const Nn=[{label:"周1",value:O(10,70)},{label:"周2",value:O(10,70)},{label:"周3",value:O(10,70)},{label:"周4",value:O(10,70)},{label:"周5",value:O(10,70)},{label:"周6",value:O(10,70)},{label:"周7",value:O(10,70)}],tn=gn("#d3-chart").append("svg").attr("width",pn).attr("height",dn);function an(r){const{svg:c,data:y,type:x,translate:h}=r,v=y.reduce((n,p)=>n+p.value,0);let o=0,e=n=>200;x==="arc"&&(o=100),x==="rose"&&(e=n=>n.value/v*100+170);const g=Mn().innerRadius(o).outerRadius(n=>e(n)).padRadius(100).padAngle(2/100).cornerRadius(8),u=c.append("g").attr("transform",h).selectAll("path").data(y).enter().append("g");u.append("path").attr("fill",(n,p)=>xn[p]).attr("d",g),u.append("text").text(n=>n.data.label).attr("transform",n=>{const p=n.endAngle*180/Math.PI,a=(n.endAngle-n.startAngle)*180/Math.PI;let l=p-a/2,f=140;return l>270?(l-=275,f=-140):l-=85,`rotate(${l}) translate(${f}, -10)`})}const rn=Dn().value(r=>r.value)(Nn);an({svg:tn,data:rn,type:"arc",translate:"translate(200, 300)"});an({svg:tn,data:rn,type:"pie",translate:"translate(600, 300)"});an({svg:tn,data:rn,type:"rose",translate:"translate(1000, 300)"});
