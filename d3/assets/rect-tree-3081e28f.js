import{g as f,s as V,w as q,h as N}from"./config-5b4cdd90.js";import{o as j}from"./ordinal-ba9b4969.js";import{S as z}from"./Set3-b8bb04aa.js";import"./init-77b53fdd.js";import"./colors-98f238a0.js";function C(n){var t=0,i=n.children,r=i&&i.length;if(!r)t=1;else for(;--r>=0;)t+=i[r].value;n.value=t}function L(){return this.eachAfter(C)}function O(n,t){let i=-1;for(const r of this)n.call(t,r,++i,this);return this}function D(n,t){for(var i=this,r=[i],a,o,u=-1;i=r.pop();)if(n.call(t,i,++u,this),a=i.children)for(o=a.length-1;o>=0;--o)r.push(a[o]);return this}function W(n,t){for(var i=this,r=[i],a=[],o,u,h,s=-1;i=r.pop();)if(a.push(i),o=i.children)for(u=0,h=o.length;u<h;++u)r.push(o[u]);for(;i=a.pop();)n.call(t,i,++s,this);return this}function $(n,t){let i=-1;for(const r of this)if(n.call(t,r,++i,this))return r}function b(n){return this.eachAfter(function(t){for(var i=+n(t.data)||0,r=t.children,a=r&&r.length;--a>=0;)i+=r[a].value;t.value=i})}function E(n){return this.eachBefore(function(t){t.children&&t.children.sort(n)})}function H(n){for(var t=this,i=Z(t,n),r=[t];t!==i;)t=t.parent,r.push(t);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function Z(n,t){if(n===t)return n;var i=n.ancestors(),r=t.ancestors(),a=null;for(n=i.pop(),t=r.pop();n===t;)a=n,n=i.pop(),t=r.pop();return a}function F(){for(var n=this,t=[n];n=n.parent;)t.push(n);return t}function G(){return Array.from(this)}function J(){var n=[];return this.eachBefore(function(t){t.children||n.push(t)}),n}function K(){var n=this,t=[];return n.each(function(i){i!==n&&t.push({source:i.parent,target:i})}),t}function*P(){var n=this,t,i=[n],r,a,o;do for(t=i.reverse(),i=[];n=t.pop();)if(yield n,r=n.children)for(a=0,o=r.length;a<o;++a)i.push(r[a]);while(i.length)}function R(n,t){n instanceof Map?(n=[void 0,n],t===void 0&&(t=X)):t===void 0&&(t=U);for(var i=new A(n),r,a=[i],o,u,h,s;r=a.pop();)if((u=t(r.data))&&(s=(u=Array.from(u)).length))for(r.children=u,h=s-1;h>=0;--h)a.push(o=u[h]=new A(u[h])),o.parent=r,o.depth=r.depth+1;return i.eachBefore(nn)}function Q(){return R(this).eachBefore(Y)}function U(n){return n.children}function X(n){return Array.isArray(n)?n[1]:null}function Y(n){n.data.value!==void 0&&(n.value=n.data.value),n.data=n.data.data}function nn(n){var t=0;do n.height=t;while((n=n.parent)&&n.height<++t)}function A(n){this.data=n,this.depth=this.height=0,this.parent=null}A.prototype=R.prototype={constructor:A,count:L,each:O,eachAfter:W,eachBefore:D,find:$,sum:b,sort:E,path:H,ancestors:F,descendants:G,leaves:J,links:K,copy:Q,[Symbol.iterator]:P};function tn(n){if(typeof n!="function")throw new Error;return n}function _(){return 0}function B(n){return function(){return n}}function en(n){n.x0=Math.round(n.x0),n.y0=Math.round(n.y0),n.x1=Math.round(n.x1),n.y1=Math.round(n.y1)}function rn(n,t,i,r,a){for(var o=n.children,u,h=-1,s=o.length,v=n.value&&(r-t)/n.value;++h<s;)u=o[h],u.y0=i,u.y1=a,u.x0=t,u.x1=t+=u.value*v}function an(n,t,i,r,a){for(var o=n.children,u,h=-1,s=o.length,v=n.value&&(a-i)/n.value;++h<s;)u=o[h],u.x0=t,u.x1=r,u.y0=i,u.y1=i+=u.value*v}var un=(1+Math.sqrt(5))/2;function on(n,t,i,r,a,o){for(var u=[],h=t.children,s,v,c=0,y=0,e=h.length,p,m,d=t.value,l,g,x,k,M,I,w;c<e;){p=a-i,m=o-r;do l=h[y++].value;while(!l&&y<e);for(g=x=l,I=Math.max(m/p,p/m)/(d*n),w=l*l*I,M=Math.max(x/w,w/g);y<e;++y){if(l+=v=h[y].value,v<g&&(g=v),v>x&&(x=v),w=l*l*I,k=Math.max(x/w,w/g),k>M){l-=v;break}M=k}u.push(s={value:l,dice:p<m,children:h.slice(c,y)}),s.dice?rn(s,i,r,a,d?r+=m*l/d:o):an(s,i,r,d?i+=p*l/d:a,o),d-=l,c=y}return u}const cn=function n(t){function i(r,a,o,u,h){on(t,r,a,o,u,h)}return i.ratio=function(r){return n((r=+r)>1?r:1)},i}(un);function hn(){var n=cn,t=!1,i=1,r=1,a=[0],o=_,u=_,h=_,s=_,v=_;function c(e){return e.x0=e.y0=0,e.x1=i,e.y1=r,e.eachBefore(y),a=[0],t&&e.eachBefore(en),e}function y(e){var p=a[e.depth],m=e.x0+p,d=e.y0+p,l=e.x1-p,g=e.y1-p;l<m&&(m=l=(m+l)/2),g<d&&(d=g=(d+g)/2),e.x0=m,e.y0=d,e.x1=l,e.y1=g,e.children&&(p=a[e.depth+1]=o(e)/2,m+=v(e)-p,d+=u(e)-p,l-=h(e)-p,g-=s(e)-p,l<m&&(m=l=(m+l)/2),g<d&&(d=g=(d+g)/2),n(e,m,d,l,g))}return c.round=function(e){return arguments.length?(t=!!e,c):t},c.size=function(e){return arguments.length?(i=+e[0],r=+e[1],c):[i,r]},c.tile=function(e){return arguments.length?(n=tn(e),c):n},c.padding=function(e){return arguments.length?c.paddingInner(e).paddingOuter(e):c.paddingInner()},c.paddingInner=function(e){return arguments.length?(o=typeof e=="function"?e:B(+e),c):o},c.paddingOuter=function(e){return arguments.length?c.paddingTop(e).paddingRight(e).paddingBottom(e).paddingLeft(e):c.paddingTop()},c.paddingTop=function(e){return arguments.length?(u=typeof e=="function"?e:B(+e),c):u},c.paddingRight=function(e){return arguments.length?(h=typeof e=="function"?e:B(+e),c):h},c.paddingBottom=function(e){return arguments.length?(s=typeof e=="function"?e:B(+e),c):s},c.paddingLeft=function(e){return arguments.length?(v=typeof e=="function"?e:B(+e),c):v},c}const ln={name:"地球",children:[{name:"亚洲",children:[{name:"中国",children:[{name:"广州",count:f(1,10)},{name:"北京",count:f(1,10)},{name:"上海",count:f(1,10)}]}]},{name:"欧洲",children:[{name:"英国",children:[{name:"伦敦",count:f(1,10)},{name:"爱丁堡",count:f(1,10)}]},{name:"法国",children:[{name:"巴黎",count:f(1,10)}]}]},{name:"非洲",children:[{name:"埃及",children:[{name:"沙卡拉",count:f(1,10)},{name:"亚历山大",count:f(1,10)}]},{name:"南非",children:[{name:"开普敦",count:f(1,10)},{name:"约翰内斯堡",count:f(1,10)}]}]},{name:"美洲",children:[{name:"美国",children:[{name:"纽约",count:f(1,10)}]},{name:"加拿大",children:[{name:"渥太华",count:f(1,10)}]},{name:"巴西",children:[{name:"圣保罗",count:f(1,10)}]},{name:"阿根廷",children:[{name:"布宜诺斯艾利斯",count:f(1,10)}]}]},{name:"大洋洲",children:[{name:"澳大利亚",children:[{name:"悉尼",count:f(1,10)}]},{name:"新西兰",children:[{name:"奥克兰",count:f(1,10)}]}]}]},T=V("#d3-chart").append("svg").attr("width",q).attr("height",N),S=R(ln).sum(n=>n.count).sort((n,t)=>n.value-t.value);hn().size([q,N]).round(!0).padding(1)(S);const sn=j(z);T.append("g").attr("class","rect-tree").selectAll().data(S.leaves()).join("rect").attr("class","cell").attr("x",n=>n.x0).attr("y",n=>n.y0).attr("width",n=>n.x1-n.x0).attr("height",n=>n.y1-n.y0).attr("fill",(n,t)=>sn(t));function dn(n,t){const i=t.getBBox().width;return n.x1-n.x0>=i}T.append("g").attr("class","rect-text").selectAll().data(S.leaves()).join("text").attr("class","cell-text").attr("transform",n=>`translate(${(n.x0+n.x1)/2},${(n.y0+n.y1)/2})`).attr("fill","#555555").attr("text-anchor","middle").attr("font-size",14).text(n=>n.data.name).text(function(n){return dn(n,this)?n.data.name:"..."});
