import{w as n,d as e,H as t,k as o,q as i,o as r,x as a,$ as l,a0 as u,n as s,r as c,Z as d,S as p,U as f,a1 as m,f as g,Y as v,F as y}from"./vue-8d5f356c.js";import{a as h}from"./index-d70d067a.js";import{_ as b}from"./plugin-vueexport-helper-1b428a4d.js";import"./request-93d71c74.js";import"./antd-ca98a620.js";var C,S=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],w=function(n){return-1!==S.map((function(n){return n.toLowerCase()})).indexOf(n.toLowerCase())},j=function(e,t,o,i,r,a){i.setContent(a()),o.attrs["onUpdate:modelValue"]&&function(e,t,o,i){var r=e.modelEvents?e.modelEvents:null,a=Array.isArray(r)?r.join(" "):r;n(i,(function(n,t){o&&"string"==typeof n&&n!==t&&n!==o.getContent({format:e.outputFormat})&&o.setContent(n)})),o.on(a||"change input undo redo",(function(){t.emit("update:modelValue",o.getContent({format:e.outputFormat}))}))}(t,o,i,r),function(n,e,t){Object.keys(e).filter(w).forEach((function(o){var i=e[o];"function"==typeof i&&("onInit"===o?i(n,t):t.on(o.substring(2),(function(n){return i(n,t)})))}))}(e,o.attrs,i)},E=0,V=function(n){var e=Date.now();return n+"_"+Math.floor(1e9*Math.random())+ ++E+String(e)},D=function(n){return void 0===n||""===n?[]:Array.isArray(n)?n:n.split(" ")},M=function(){return{listeners:[],scriptId:V("tiny-script"),scriptLoaded:!1}},x=(C=M(),{load:function(n,e,t){C.scriptLoaded?t():(C.listeners.push(t),n.getElementById(C.scriptId)||function(n,e,t,o){var i=e.createElement("script");i.referrerPolicy="origin",i.type="application/javascript",i.id=n,i.src=t;var r=function(){i.removeEventListener("load",r),o()};i.addEventListener("load",r),e.head&&e.head.appendChild(i)}(C.scriptId,n,e,(function(){C.listeners.forEach((function(n){return n()})),C.scriptLoaded=!0})))},reinitialize:function(){C=M()}}),O=function(){var n="undefined"!=typeof window?window:global;return n&&n.tinymce?n.tinymce:null},U={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(n){return"html"===n||"text"===n}}},A=globalThis&&globalThis.__assign||function(){return A=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var i in e=arguments[t])Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i]);return n},A.apply(this,arguments)},L=e({props:U,setup:function(e,c){var d=e.init?A({},e.init):{},p=t(e),f=p.disabled,m=p.modelValue,g=p.tagName,v=o(null),y=null,h=e.id||V("tiny-vue"),b=e.init&&e.init.inline||e.inline,C=!!c.attrs["onUpdate:modelValue"],S=!0,w=e.initialValue?e.initialValue:"",E="",M=function(){var n,t,o,i=(n=S,C?function(){return(null==m?void 0:m.value)?m.value:""}:function(){return n?w:E}),r=A(A({},d),{readonly:e.disabled,selector:"#"+h,plugins:(t=d.plugins,o=e.plugins,D(t).concat(D(o))),toolbar:e.toolbar||d.toolbar,inline:b,setup:function(n){y=n,n.on("init",(function(t){return j(t,e,c,n,m,i)})),"function"==typeof d.setup&&d.setup(n)}});(function(n){return null!==n&&"textarea"===n.tagName.toLowerCase()})(v.value)&&(v.value.style.visibility=""),O().init(r),S=!1};n(f,(function(n){var e;null!==y&&("function"==typeof(null===(e=y.mode)||void 0===e?void 0:e.set)?y.mode.set(n?"readonly":"design"):y.setMode(n?"readonly":"design"))})),n(g,(function(n){var e;C||(E=y.getContent()),null===(e=O())||void 0===e||e.remove(y),i((function(){return M()}))})),r((function(){if(null!==O())M();else if(v.value&&v.value.ownerDocument){var n=e.cloudChannel?e.cloudChannel:"6",t=e.apiKey?e.apiKey:"no-api-key",o=null==e.tinymceScriptSrc?"https://cdn.tiny.cloud/1/"+t+"/tinymce/"+n+"/tinymce.min.js":e.tinymceScriptSrc;x.load(v.value.ownerDocument,o,M)}})),a((function(){null!==O()&&O().remove(y)})),b||(l((function(){S||M()})),u((function(){var n;C||(E=y.getContent()),null===(n=O())||void 0===n||n.remove(y)})));return c.expose({rerender:function(n){var e;E=y.getContent(),null===(e=O())||void 0===e||e.remove(y),d=A(A({},d),n),i((function(){return M()}))}}),function(){return b?function(n,e,t,o){return n(o||"div",{id:e,ref:t})}(s,h,v,e.tagName):s("textarea",{id:h,visibility:"hidden",ref:v})}}});const k=b(e({name:"TinymceEditor",components:{Editor:L},model:{porp:"msg",event:"cc"},props:{msg:null,width:{type:[Number,String],default:"100%"},height:{type:[Number,String],default:300}},setup(e,i){const{width:r,height:a}=t(e),l=o(),u=o(),s=c({width:r,height:a,language:"zh_CN",branding:!1,images_upload_url:"https://httpbin.org/post",images_upload_handler(n,e,t){((n,e,t)=>{h.fileUpload({blobInfo:n}).then((n=>e(n.data.files.upload_file))).catch((n=>t(n)))})(n,e,t)},plugins:["advlist autolink lists link image charmap print preview anchor","searchreplace visualblocks code fullscreen","insertdatetime media table paste code help wordcount","image"],toolbar:"undo redo | formatselect | bold italic backcolor | image insertfile alignleft aligncenter alignright alignjustify bullist numlist outdent indent removeformat help"});return n(l,(()=>{i.emit("cc",l.value)})),{content:l,editorRef:u,editorInit:s}}}),[["render",function(n,e,t,o,i,r){const a=d("editor");return p(),f(a,{ref:"editorRef",modelValue:n.content,"onUpdate:modelValue":e[0]||(e[0]=e=>n.content=e),"api-key":"k4llym7ey74hcmxd7bftnmbacjzy0juzywoaml6i8a90rvy9",init:n.editorInit},null,8,["modelValue","init"])}]]),I=e({name:"TinymceView",components:{TinymceEditor:k},setup:()=>({content:o()})}),P=v("p",null,"tinymce 富文本编辑器",-1),B=["innerHTML"];const _=b(I,[["render",function(n,e,t,o,i,r){const a=k;return p(),m(y,null,[P,g(a,{modelValue:n.content,"onUpdate:modelValue":e[0]||(e[0]=e=>n.content=e),height:400},null,8,["modelValue"]),v("div",{innerHTML:n.content},null,8,B)],64)}]]);export{_ as default};
